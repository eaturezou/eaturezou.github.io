---
layout: post
author: eature
published: true
categories: MySQL
tags:
- mysql
---

在平常的MySQL操作中， 除了基本的CURD外， 接触最多的应该就是事务和索引了  
接下来， 依次对事务以及索引的知识点进行归纳总结  

#### 事务

在平常的使用中， 用到事务最多的就是事务的原子性， 即多条语句的的执行， 要么都成功， 要么都失败， 我们知道， 事务的四个特性是ACID， 即  
1. 原子性 Atomicity
2. 一致性 Consistency
3. 隔离性 Isolation
4. 持久性 Durability

##### 原子性
原子性就是， 在事务中的操作， 要么全部完成， 中途有操作失败， 则回滚到事务开始时的状态， 在事务开始的时候，MySQL会记录undo log，undo log记录的是修改前数据的值， 在事务中途， 如果数据库挂逼了， 或者执行了回滚操作， 就根据记录的undo log来将数据恢复成原来的样子， 在事务提交后， undo log不会马上被删除， 而是放在待删除队列中， 再判断是否需要删除。 
##### 一致性
一致性是指事务使得系统从一个一致的状态转换到另一个一致状态，对于这句话的理解是， 假设数据为10， 当数据减1得到另外一个数据， 那么这个数据一定是9， 即数据库数据的两个状态一个是逻辑上成立的， 事务可以不同程度的一致性：  
##### 隔离性
隔离性指的是两个不同事务之前相互隔离， 互不影响， 隔离级别越严实， 效率就会越低， 隔离级别包括以下  
1. 读未提交， 一个事务还没提交的情况下， 他的更改就可以被其他事务看到
2. 读提交， 一个数据提交以后， 他的修改才能被其他事务看到
3. 可重复读， 一个事务在执行过成中看到的数据总是一样的， 在可重复读隔离级别下， 未提交的事务不会被其他事务看到
4. 串行化， 就是写会加写锁， 读会加读锁， 当读写冲突的时候， 后访问的事务需要等前一个事务执行完成才可以继续执行
##### 持久性
持久性就是事务提交后，对系统的影响是永久的， 持久性是有InnoDB的`redo log`来维护的， 在MySQL中， 每条更新操作都会写一条`redo log`， redo log记录的是物理操作， 记录的是对每个数据页的修改， 所有的更新操作都会先写到redo log中， 然后在将redo log中的数据更新到磁盘中， 因此， 即使数据库异常重启或者宕机， 所有的操作还是记录才redo log中， 当数据库实例启动以后， 可以读取redo log中的数据操作， 将宕机前为写入到数据文件的数据再一次写入， 因此数据不会丢失， 保证了数据的持久性

#### 索引
