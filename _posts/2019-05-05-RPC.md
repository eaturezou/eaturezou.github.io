---
layout: post
author: eature
published: true
categories: PHP
tags:
- RPC
- protobuf
---

### RPC服务

#### RPC的简单介绍
  RPC,远程过程调用(Remote Procedure Call)，是一种远程调用方式, 通过RPC可以像调用本地方法一样调用远端机器上的服务， 将服务器与服务器之间的交互变得透明， 远程过程调用主要的应用场景就是微服务架构  
  > #### 单体架构与微服务架构
  > ##### 单体架构
  > 顾名思义， 单体架构就是项目相关的服务都集成在一个项目中， 比如商品服务， 用户服务， 活动服务等  
  > 这样做的好处在于：  
  > 1. 部署容易， 所有的文件都集中在一个目录或者包中
  > 2. 测试与调试成本相对较低  
  >   
  > 当然也有其对用的缺点：
  > 1. 第一个是代码的维护方面， 把所有的代码都堆在一起的话， 项目会越来越大， 导致后面理解整体代码越来越困难， 需要对整个项目有较深的理解， 否则容易使整个项目难以维护  
  > 2. 扩展性差， 在需要扩展功能模块的时候， 需要对整个项目经性整合
  > 3. 复用性差， 对于用户服务等基础模块  
  >
  > 微服务架构
  > 微服务架构是将每个功能模块差分成一个个小的项目部署在同一或者不同的机子上， 服务间相互调用来组成一个大的项目  
  > 微服务架构的好处在于：  
  > 1. 每个功能模块是单独的项目， 一个模块宕机不会导致全部服务不可用， 提供服务的可用性
  > 2. 多技术栈开发， 每个模块可以用不同的技术栈开发，只要暴露对用的调用方法给其他服务调用即可
  > 3. 可维护性强， 每个模块都只负责一个功能， 代码的整个容量不会无止尽的上升
  > 4. 独立部署上线， 每个模块独立， 上线部署的时候不会影响到其他模块  
  >  
  > 缺点则在于：
  > 1. 运维成本高， 需要维护多个项目
  > 2. 会有冗余的代码， 每个服务间有一些小模块， 而这些模块不足以到拆分成一个微服务， 就会造成代码冗余
  
#### RPC的调用过程
RPC就是调用客户端与RPC服务之间的通讯， RPC的协议可以用TCP、UDP、HTTP来实现  实现微服务架构的话这里推荐使用TCP协议来实现
* TCP支持保持长连接， 调用服务的时候只需要第一次调用的使用三次握手建立连接即可， 从性能和网络开销来说具备了优势
* HTTP的话每次调用都要通过三次握手建立HTTP连接， 会浪费很多的带宽和资源
* 当然， 如果服务需要对外暴露得话， HTTP的RESTFUL API会比RPC更加具有优势

 